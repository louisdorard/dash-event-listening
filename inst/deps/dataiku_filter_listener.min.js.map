{"version":3,"file":"dataiku_filter_listener.min.js","mappings":"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","sources":["webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///external window \"React\"","webpack:///external window \"PropTypes\"","webpack:///./src/lib/components/DataikuFilterListener.react.js","webpack:///./node_modules/dash-extensions-js/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","var getCurrentScript = function() {\n    var script = document.currentScript;\n    if (!script) {\n        /* Shim for IE11 and below */\n        /* Do not take into account async scripts and inline scripts */\n\n        var doc_scripts = document.getElementsByTagName('script');\n        var scripts = [];\n\n        for (var i = 0; i < doc_scripts.length; i++) {\n            scripts.push(doc_scripts[i]);\n        }\n\n        scripts = scripts.filter(function(s) { return !s.async && !s.text && !s.textContent; });\n        script = scripts.slice(-1)[0];\n    }\n\n    return script;\n};\n\nvar isLocalScript = function(script) {\n    return /\\/_dash-component-suites\\//.test(script.src);\n};\n\nObject.defineProperty(__webpack_require__, 'p', {\n    get: (function () {\n        var script = getCurrentScript();\n\n        var url = script.src.split('/').slice(0, -1).join('/') + '/';\n\n        return function() {\n            return url;\n        };\n    })()\n});\n\nif (typeof jsonpScriptSrc !== 'undefined') {\n    var __jsonpScriptSrc__ = jsonpScriptSrc;\n    jsonpScriptSrc = function(chunkId) {\n        var script = getCurrentScript();\n        var isLocal = isLocalScript(script);\n\n        var src = __jsonpScriptSrc__(chunkId);\n\n        if(!isLocal) {\n            return src;\n        }\n\n        var srcFragments = src.split('/');\n        var fileFragments = srcFragments.slice(-1)[0].split('.');\n\n        fileFragments.splice(1, 0, \"v0_0_1m1735303604\");\n        srcFragments.splice(-1, 1, fileFragments.join('.'))\n\n        return srcFragments.join('/');\n    };\n}\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"React\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"PropTypes\"];","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { getDescendantProp } from 'dash-extensions-js'\n\n/**\n * The DataikuFilterListener component listens for events from the document object or children if provided.\n */\nexport default class DataikuFilterListener extends Component {\n\n    constructor(props) {\n        super(props);\n        this.myRef = React.createRef();  // create reference to enable looping children later\n        this.eventHandler = this.eventHandler.bind(this);\n        this.getSources = this.getSources.bind(this);\n    }\n\n    getSources() {\n        return [window];\n    }\n\n    eventHandler(e) {\n        if (this.props.logging) {\n            console.log(e);\n        }\n        const eventProps = this.props.events.filter(o => o[\"event\"] === e.type).map(o => o[\"props\"] ? o[\"props\"] : [])[0];\n        const eventData = eventProps.reduce(function (o, k) { o[k] = getDescendantProp(e, k); return o; }, {});\n        //        eventData.id = e.srcElement.id;\n        let filters = [];\n        if (eventData.data && eventData.data.type && eventData.data.type === 'filters' && eventData.data.filters) {\n            filters = eventData.data.filters;\n        }\n        this.props.setProps({ filters: filters });\n    }\n\n    componentDidMount() {\n        const events = this.props.events.map(o => o[\"event\"]);\n        this.getSources().forEach(s => events.forEach(e => s.addEventListener(e, this.eventHandler, this.props.useCapture)));\n    }\n\n    componentWillUnmount() {\n        const events = this.props.events.map(o => o[\"event\"]);\n        this.getSources().forEach(s => events.forEach(e => s.removeEventListener(e, this.eventHandler, this.props.useCapture)));\n    }\n\n    render() {\n        return <div className={this.props.className} style={this.props.style} ref={this.myRef}>\n            {this.props.children}\n        </div>;\n    }\n};\n\nDataikuFilterListener.defaultProps = {\n    events: [{ \"event\": \"message\", \"props\": [\"data\"] }],\n    filters: {},\n    logging: false,\n    useCapture: false\n};\n\nDataikuFilterListener.propTypes = {\n    /**\n     * The ID used to identify this component in Dash callbacks.\n     */\n    id: PropTypes.string,\n\n    /**\n     * The event entry specifies which event to listen to, e.g. \"click\" for click events. The \"props\" entry specifies\n     what event properties to record, e.g. [\"x\", \"y\"] to get the cursor position.\n     */\n    events: PropTypes.arrayOf(PropTypes.shape({\n        event: PropTypes.string,\n        props: PropTypes.arrayOf(PropTypes.string)\n    })),\n\n    /**\n     * If true, event information is logged to the javascript console. Useful if you can't remember events props.\n     */\n    logging: PropTypes.bool,\n\n    /**\n     * The children of this component. If any children are provided, the component will listen for events from these\n     components. If no children are specified, the component will listen for events from the document object.\n     */\n    children: PropTypes.node,\n\n    /**\n     * The CSS style of the component.\n     */\n    style: PropTypes.object,\n\n    /**\n     * A custom class name.\n     */\n    className: PropTypes.string,\n\n    /**\n     * Dash-assigned callback that should be called to report property changes\n     * to Dash, to make them available for callbacks.\n     */\n    setProps: PropTypes.func,\n\n    /**\n     * Values from the latest event fired by the Dataiku Dashboard Filters.\n     */\n    filters: PropTypes.array,\n\n    /**\n     * Value of useCapture used when registering event listeners.\n     */\n    useCapture: PropTypes.bool\n\n};","function isPlainObject(o) {\n   return (o === null || Array.isArray(o) || typeof o == 'function' || o.constructor === Date ) ?\n           false\n          :(typeof o == 'object');\n}\n\nfunction isFunction(functionToCheck) {\n return functionToCheck && {}.toString.call(functionToCheck) === '[object Function]';\n}\n\nfunction resolveProp(prop, context) {\n    // If it's not an object, just return.\n    if (!isPlainObject(prop)){\n        return prop\n    }\n    // Check if the prop should be resolved a variable.\n    if (prop.variable){\n        return resolveVariable(prop, context)\n    }\n    // Check if the prop should be resolved as an arrow function.\n    if (prop.arrow){\n        return (...args) => prop.arrow\n    }\n    // If none of the special properties are present, do nothing.\n    return prop\n}\n\nfunction resolveVariable(prop, context){\n    // Resolve the function.\n    const variable = getDescendantProp(window, prop.variable)\n    // If it's not there, raise an error.\n    if(variable === undefined){\n        throw new Error(\"No match for [\" + prop.variable + \"] in the global window object.\")\n    }\n    // If it's a function, add context.\n    if(isFunction(variable) && context){\n        return (...args) => variable(...args, context)\n    }\n    // Otherwise, use the variable as-is.\n    return variable\n}\n\nfunction getDescendantProp(obj, desc) {\n    const arr = desc.split(\".\");\n    while(arr.length && (obj = obj[arr.shift()]));\n    return obj;\n}\n\nfunction resolveProps(props, functionalProps, context){\n    let nProps = Object.assign({}, props);\n    for(let prop of functionalProps) {\n        if (nProps[prop]) {\n            nProps[prop] = resolveProp(nProps[prop], context);\n        }\n    }\n    return nProps\n}\n\n\nexport {\n    resolveProp,\n    resolveProps,\n    getDescendantProp\n};"],"names":["url","__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","getCurrentScript","script","document","currentScript","doc_scripts","getElementsByTagName","scripts","i","length","push","filter","s","async","text","textContent","slice","src","split","join","jsonpScriptSrc","__jsonpScriptSrc__","chunkId","isLocal","test","srcFragments","fileFragments","splice","window","DataikuFilterListener","_Component","props","_this","_classCallCheck","_callSuper","myRef","React","eventHandler","bind","getSources","_inherits","e","this","logging","console","log","eventData","events","type","map","reduce","k","desc","arr","shift","getDescendantProp","filters","data","setProps","_this2","forEach","addEventListener","useCapture","_this3","removeEventListener","className","style","ref","children","Component","defaultProps","propTypes","id","PropTypes","event"],"sourceRoot":""}